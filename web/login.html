<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login</title>
    <link rel="stylesheet" href="./monospace-web/index.css" />
    <link rel="stylesheet" href="./monospace-web/reset.css" />
</head>
<body>
 <h1>Logging In</h1>
 <form class="grid" id="emailForm">
     <p>We couldn't get the email from your account, please enter it below.</p>
     <label>Your Account Email:
         <input id="email" type="text" placeholder="me@company.com" maxlength="60"></label>
     <button type="button" id="submitEmail">
         Continue
     </button>
 </form>
<script>
    const emailForm = document.getElementById('myDiv');
    emailForm.style.display = 'none';
    // I'll get back following in querystrings:
    // token, walletAddress, email
    // Get the current URL query string (everything after ?)
    const queryString = window.location.search;

    // Use URLSearchParams to parse the query string
    const params = new URLSearchParams(queryString);

    // Loop through each query parameter and log it
    console.log('Query Parameters:');
    params.forEach((value, key) => {
        console.log(`${key}: ${value}`);
        localStorage.setItem(key, value);
    });
    const email = localStorage.getItem("email");
    if (email == null || email === '') {
        emailForm.style.display = 'block';
    } else {
    window.location.href = "/app.html"; }

    document.addEventListener("DOMContentLoaded", () => {
        // Get the input and button elements by their IDs
        const textInput = document.getElementById('email');
        const myButton = document.getElementById('submitEmail');

        // Attach a click event listener to the button
        myButton.addEventListener('click', () => {
            // Grab the value from the text input
            const inputValue = textInput.value;
            if (inputValue == null || inputValue === '') {
                alert('Please enter a valid email address.');
            } else {
            localStorage.setItem("email", inputValue);
            window.location.href = "/app.html";
            }
        });
    });
</script>
</body>
</html>